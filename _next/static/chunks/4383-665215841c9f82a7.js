"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4383],{14383:function(e,t,n){n.d(t,{Z:function(){return k}});var r=n(24246),o=n(28862),i=n(95045),a=n(35230),s=n.n(a),u=n(14206),c=n.n(u),l=n(77854);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){d(e,t,n[t])}))}return e}var f=2e4,m=c().create({baseURL:l.jk.API_BASE_URL,timeout:f});function h(e){var t=e.url,n=e.method,r=e.queryParams,o=e.data,i=e.responseType,a=e.authToken,s=e.additionalHeaders,u=e.timeout,c=(e.store,e.lastFetchId);return new Promise((function(e,l){var d=r||{},h=o||{};"head"!==n&&"get"!==n||(h=void 0);var y=setTimeout((function(){}),u?u+2e3:22e3);console.log("HTTP request -> ",n,":",t);var g=s||{},x={method:n,url:t,params:d,data:h,responseType:i||"json",headers:p(a?{Authorization:"Bearer ".concat(a)}:{},g),timeout:u||f};m(x).then((function(t){clearTimeout(y),console.log("HTTP response =>",t),e({data:t.data,lastFetchId:c})})).catch((function(e){clearTimeout(y),console.log("HTTP error => ",e),console.log("HTTP error.response => ",e.response);var t={errorCode:0};e.response&&(t=p({errorCode:e.response.status},e.response.data)),l(t)}))}))}function y(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){y(i,r,o,a,s,"next",e)}function s(e){y(i,r,o,a,s,"throw",e)}a(void 0)}))}}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){x(e,t,n[t])}))}return e}var v=function(e){var t=e.file_name;switch(t.split(".")[t.split(".").length-1]){case"pdf":return{"Content-type":"application/pdf","Access-Control-Request-Headers":"content-type","Access-Control-Request-Method":"PUT"};case"png":return{"Content-type":"image/png","Access-Control-Request-Headers":"content-type","Access-Control-Request-Method":"PUT"};case"jpeg":return{"Content-type":"image/jpeg","Access-Control-Request-Headers":"content-type","Access-Control-Request-Method":"PUT"};case"jpg":return{"Content-type":"image/jpg","Access-Control-Request-Headers":"content-type","Access-Control-Request-Method":"PUT"};default:return{"Content-type":"application/xml"}}},T=function(){var e=g(s().mark((function e(t,n){var r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=v(n),e.next=4,h({url:t,method:"post",data:n,responseType:"json"});case 4:return o=e.sent,e.abrupt("return",{url:o.data.content_signed_url,method:"PUT",headers:b({},r)});case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0,"@utils/getSignedUrl");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),j=function(){var e=g(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(t);case 3:return n=e.sent,e.abrupt("return",n);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0,"@utils/imageUploadTexteditor");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),C=n(83553),S=n(86677),w=n(27378),P=n(9078),A=n(55480),E=n(40504);function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(u){s=!0,o=u}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var R=w.lazy((function(){return Promise.all([n.e(5319),n.e(5475)]).then(n.bind(n,65475))})),k=(0,o.Z)((function(e){var t=e.doCreateCommunityPost,n=e.currentCommunityDetails,o=e.communityState,a=e.communitiesFetchStatus,s=e.doFetchCommunityUrlToken,u=e.communityUrlToken,c=e.communityError,l=e.isEditMode,d=e.currentTitle,p=e.currentContent,f=e.currentTab,m=e.postId,h=e.doUpdateCommunityPost,y=e.onCancel,g=e.userRoleType,x=(0,P.$)("community").t,b=O(w.useState(f||"TEXT"),2),v=b[0],U=b[1],k=O(w.useState(p||""),2),I=k[0],F=k[1],_=O(w.useState(d||""),2),H=_[0],L=_[1],M=function(){l?h({communityId:n.id,postId:m,title:H,content:I}):t({id:n.id,postTypeId:"TEXT"===v?C.SV.TEXT:C.SV.ARTICLE,title:H,slug:H.replace(/[^\-\w\s]/gi,"").replace(/[^a-zA-Z0-9-]/g,"-").toLowerCase(),content:I,featured_image:""})};return(0,w.useEffect)((function(){g&&s(n.id,g)}),[g]),(0,w.useEffect)((function(){return a===i.UK.SUCCESS&&o===C.RW.CREATE_COMMUNITY_POST?(S.default.reload(),(0,E.FN)({message:x("postCreateSuccess"),position:"top-right"})):a===i.UK.FAILED&&o===C.RW.CREATE_COMMUNITY_POST&&c?(0,E.FN)({message:c.errorMessage,position:"top-right"}):void 0}),[o,a]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(A.xu,{sx:{boxShadow:"card.normal",overflow:"hidden",borderRadius:5},children:[l?(0,r.jsx)(r.Fragment,{}):(0,r.jsxs)(A.kC,{px:2,children:[(0,r.jsx)(E.fK,{activeTab:v,setActiveTab:U,text:"Text",link:"TEXT"}),(0,r.jsx)(E.fK,{activeTab:v,setActiveTab:U,text:"post",link:"ARTICLE"})]}),"TEXT"===v&&(0,r.jsxs)(A.xu,{children:[(0,r.jsx)(A.xu,{sx:{flexGrow:1,mt:2},children:(0,r.jsx)(E.gx,{value:H,onChangeFunction:L,placeholder:x("common:titleHere"),style:{px:5,minWidth:"100%",maxWidth:"100%",height:"24px",fontFamily:"body",border:"none",outline:"none",overflow:"hidden",lineHeight:"min-content"}})}),(0,r.jsx)(A.xu,{sx:{flexGrow:1},children:(0,r.jsx)(E.gx,{value:I,onChangeFunction:F,placeholder:x("common:startWritingHere"),style:{px:5,minWidth:"100%",maxWidth:"100%",height:"100%",fontFamily:"body",border:"none",outline:"none"}})})]}),"ARTICLE"===v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.xu,{sx:{flexGrow:1,mt:2},children:(0,r.jsx)(E.gx,{value:H,onChangeFunction:L,placeholder:x("common:titleHere"),style:{px:5,minWidth:"100%",maxWidth:"100%",height:"24px",fontFamily:"body",border:"none",outline:"none",overflow:"hidden",lineHeight:"min-content"}})}),(0,r.jsx)(w.Suspense,{fallback:(0,r.jsx)(A.xu,{height:"200px",children:"..."}),children:(0,r.jsx)(A.xu,{sx:{"& .redactor-box.redactor-styles-on":{border:0},"& .redactor-styles":{minHeight:"300px"}},children:(0,r.jsx)(R,{urlToken:u,signedUrlData:{action:38,uploadKey:"community_id",uploadValue:n.id},imageUploadMethods:{getSignedUrl:T,uploadImage:j},buttons:["bold","italic","underline","lists","image","link"],editor:I,handleEditor:function(e){return F(e)},signedUrlId:1})})})]}),(0,r.jsxs)(A.kC,{mb:2,pl:3,sx:{"& button":{borderRadius:2}},children:[(0,r.jsx)(E.zx,{onClick:function(){return M()},colorVariant:"primary",text:x(l?"updatePost":"post")}),l&&y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.xu,{ml:2}),(0,r.jsx)(E.zx,{buttonType:"outline",onClick:function(){return y()},colorVariant:"secondary",text:x("cancel")})]}):(0,r.jsx)(r.Fragment,{})]})]})})}))},77854:function(e,t,n){n.d(t,{jk:function(){return r},UK:function(){return o}});var r={API_BASE_URL:"https://api.learnyst.com",UPLOAD_URL:"https://cdn-getsignedurl.learnyst.com"},o={IDLE:0,IN_PROGRESS:1,SUCCESS:2,FAILED:3}}}]);