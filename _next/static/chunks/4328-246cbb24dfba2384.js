"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4328],{38398:function(e,t,n){n.d(t,{pK:function(){return s.pK},T_:function(){return s.T_},iF:function(){return s.iF},b3:function(){return s.b3},E_:function(){return s.E_},MF:function(){return s.MF},hC:function(){return s.hC},J5:function(){return s.J5},xZ:function(){return s.xZ},eq:function(){return s.eq}});var s=n(3612)},61611:function(e,t,n){n.d(t,{jk:function(){return s},UK:function(){return i}});var s={API_BASE_URL:"https://api.learnyst.com",UPLOAD_URL:"https://cdn-getsignedurl.learnyst.com"},i={IDLE:0,IN_PROGRESS:1,SUCCESS:2,FAILED:3}},44328:function(e,t,n){n.d(t,{Z:function(){return E}});var s=n(24246),i=n(27378),o=n(9078),r=n(37740),l=n(45356),u=n(72022),c=n(27953),a=n(21155);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},s=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),s.forEach((function(t){d(e,t,n[t])}))}return e}var m=function(e){var t=e.submitButtonText,n=e.inputFor,r=void 0===n?"discussion":n,d=e.inputType,m=void 0===d?"create":d,v=e.postQuestion,f=e.postReply,h=e.postTitle,x=e.courseTitle,y=e.lessonTitle,I=e.editQuestion,S=e.editReply,D=e.isPostDiscussion,g=e.postId,C=e.courseId,T=e.lessonId,j=e.isLessonLevel,b=e.discussionId,A=e.lastRequestId,U=e.placeholderText,_=e.uploadFile,k=e.uploadToken,F=e.sharedAuthToken,P=e.initialValue,L=e.attachmentUrl,E=e.getFileNameFromUrl,w=e.commentId,N=(e.setPlayerFocusState,e.bundleTitle),R=e.courseSectionId,O=e.getCurrentPosition,B=e.inputLabel,$=(0,o.$)(["discussion","common"]).t,z=(0,i.useRef)(null),H=(0,i.useRef)(null),Q=(0,i.useState)(void 0),q=Q[0],M=Q[1],Z=(0,i.useState)(a._$.NOT_UPLOADED),G=Z[0],V=Z[1],K=(0,i.useState)(0),W=K[0],J=K[1],X=(0,i.useState)(!1),Y=X[0],ee=X[1],te=(0,i.useState)(""),ne=te[0],se=te[1],ie=(0,i.useState)(!1),oe=ie[0],re=ie[1];(0,i.useEffect)((function(){L&&(M(L),V(a._$.UPLOADED),se(E(L)))}),[L]),(0,i.useEffect)((function(){H.current&&P&&(H.current.value=P,re(!0))}),[P]);var le,ue=(0,i.useCallback)((function(e){V(a._$.UPLOADED),M(e),J(0)}),[]),ce=(0,i.useCallback)((function(e){e===a.H1.FILE_SIZE_TOO_HIGH&&ee(!0),V(a._$.FAILED),J(0)}),[]),ae=(0,i.useCallback)((function(){V(a._$.IN_QUEUE)}),[]),de=(0,i.useCallback)((function(e){V(a._$.IN_PROGRESS),J(e)}),[]),pe=G===a._$.IN_PROGRESS||G===a._$.IN_QUEUE;return(0,s.jsxs)(u.kC,{sx:{flexDirection:"column"},pb:3,children:[(0,s.jsx)(l.xv,{category:"s1",textTransform:"capitalize",children:B}),(0,s.jsx)(u.xu,{py:1}),(0,s.jsx)(l.nv,{type:"textArea",numberOfLines:3,iconPosition:"leading",setInputRef:function(e){H.current=e.current},placeholderText:U,captionText:G===a._$.NOT_UPLOADED?void 0:function(){switch(G){case a._$.IN_PROGRESS:return $("common:uploadProgress",{percentile:W});case a._$.IN_QUEUE:return $("common:uploadQueue");case a._$.FAILED:return Y?$("common:fileSizeExcceeded",{size:a.ZH.MAX_ATTACHMENT_FILE_SIZE_IN_MB}):$("common:uploadFailed");case a._$.UPLOADED:return ne;default:return ne||$("attachFile")}}(),captionIcon:G===a._$.NOT_UPLOADED?void 0:c.q.attachment,captionNoOfLines:1,iconAlignment:"flex-start",onChange:function(e){var t,n,s=null!==(n=null===e||void 0===e||null===(t=e.replaceAll)||void 0===t?void 0:t.call(e," ",""))&&void 0!==n?n:e;s&&!oe?re(!0):!s&&oe&&re(!1)}}),(0,s.jsxs)(u.kC,{sx:{alignItems:"center"},pt:2,children:[(0,s.jsx)(l.zx,{onClick:function(e){var t;if(e.stopPropagation(),ne&&G!==a._$.FAILED)return z.current&&(z.current.value=""),V(a._$.NOT_UPLOADED),M(""),J(0),ee(!1),void se("");null===(t=z.current)||void 0===t||t.click()},type:"ghost",size:"small",variant:"basic",leadingIcon:G!==a._$.UPLOADED?c.q.attachment:c.q.trash,leadingIconProps:{icon:G!==a._$.UPLOADED?c.q.attachment:c.q.trash,size:null,fontSize:"p1"},disabled:pe,children:$(G===a._$.UPLOADED?"deleteAttachment":"attachFile").toLocaleUpperCase()}),(0,s.jsx)(u.xu,{px:2}),(0,s.jsx)(l.zx,{onClick:function(){var e={};if("discussion"===r){if("create"===m){var t,n;if(e=p({attachment_url:q},e,D?{post_id:g}:{course_id:C},{message:unescape(encodeURIComponent(null!==(n=null===(t=H.current)||void 0===t?void 0:t.value)&&void 0!==n?n:"")),tag:D?h:x,title:D?h:x}),j&&!D){var s=null===O||void 0===O?void 0:O();if(e=p({},e,{lesson_id:T,tag:y}),s){var i=s.currentSlide,o=s.currentVideoTime,l=s.key||"";e.discussion_link="/learn/".concat(N,"/").concat(x,"/").concat(R,"/").concat(T,"?link:").concat(i,":").concat(o,":").concat(l)}}null===v||void 0===v||v({requestPayLoadData:e},A)}else if("edit"===m){var u,c;e=p({attachment_url:q},D?{post_id:g}:{course_id:C},{discussion_board_id:b,message:unescape(encodeURIComponent(null!==(c=null===(u=H.current)||void 0===u?void 0:u.value)&&void 0!==c?c:""))}),null===I||void 0===I||I({data:e,discussionId:b},A)}}else if("reply"===r){var d,U;if("create"===m)e=p({attachment_url:q},D?{post_id:g}:{course_id:C},{discussion_board_id:b,reply_text:unescape(encodeURIComponent(null!==(U=null===(d=H.current)||void 0===d?void 0:d.value)&&void 0!==U?U:""))}),null===f||void 0===f||f({requestPayLoadData:e},A);else if("edit"===m){var _,k;e=p({},e,{attachment_url:q},D?{post_id:g}:{course_id:C},{commentId:w,reply_text:unescape(encodeURIComponent(null!==(k=null===(_=H.current)||void 0===_?void 0:_.value)&&void 0!==k?k:""))}),null===S||void 0===S||S({data:e,commentId:w},A)}}H.current&&(H.current.value="",re(!1)),z.current&&(z.current.value="",V(a._$.NOT_UPLOADED),M(void 0),J(0),ee(!1),se(""))},size:"small",disabled:!oe||pe,children:null!==(le=null===t||void 0===t?void 0:t.toLocaleUpperCase())&&void 0!==le?le:$("postDiscussion").toLocaleUpperCase()})]}),(0,s.jsx)(u.xu,{sx:{display:"none"},children:(0,s.jsx)(u.II,{ref:z,onChange:function(e){var t,n,s=null===(t=null===e||void 0===e?void 0:e.target)||void 0===t||null===(n=t.files)||void 0===n?void 0:n[0];s&&(se(s.name),null===_||void 0===_||_(s,k,D?"post_id":"course_id",D?g:C,F,D?a.UP.POST_DISCUSSION_ATTACHMENTS_UPLOAD:a.UP.DISCUSSION_ATTACHMENTS_UPLOAD,ae,ue,ce,de))},type:"file"})})]})},v=i.memo(m),f=n(38423),h=n(61320),x=n.n(h),y=n(19428),I=function(e){var t,n,r,a,d,p,m,v,h=e.comment,I=(e.stripAndDecode,e.isByCurrentUser),S=e.getFileNameFromUrl,D=e.onClickEdit,g=e.onClickDelete,C=e.isByFaculty,T=(0,i.useState)(!1),j=T[0],b=T[1],A=(0,o.$)("discussion").t,U=null===(t=S(null!==(d=null===h||void 0===h?void 0:h.attachmentUrl)&&void 0!==d?d:""))||void 0===t?void 0:t.toLocaleUpperCase();return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)(f.cS,{variant:"titleCardWithoutBorder",showHeader:!0,headerThumbnailLabel:null===h||void 0===h||null===(n=h.userInfo)||void 0===n?void 0:n.userName,headerThumbnalSize:4,headerImage:null===h||void 0===h||null===(r=h.userInfo)||void 0===r?void 0:r.profilePhotoUrl,headerThumbnailProps:{status:C?"faculty":void 0},disableHover:!0,headerTitle:(0,s.jsxs)(u.kC,{sx:{justifyContent:"space-between",width:"100%"},children:[(0,s.jsxs)(u.kC,{sx:{flexWrap:"wrap",alignItems:"center"},children:[(0,s.jsxs)(l.xv,{style:{display:"inline"},children:[null===h||void 0===h||null===(a=h.userInfo)||void 0===a?void 0:a.userName,"\xa0"]}),(0,s.jsx)(l.xv,{category:"c2",style:{display:"inline"},children:"\u2022 ".concat(x()(h.createdAt).fromNow())}),(0,s.jsx)("a",{download:U,href:"https://"+encodeURIComponent(decodeURIComponent(null!==(p=h.attachmentUrl)&&void 0!==p?p:"").replace("https://","")).replace("%2F","/")})]}),(0,s.jsxs)(u.kC,{children:[h.attachmentUrl&&(0,s.jsx)("a",{download:U,href:"https://"+encodeURIComponent(decodeURIComponent(null!==(m=h.attachmentUrl)&&void 0!==m?m:"").replace("https://","")).replace("%2F","/"),children:(0,s.jsx)(u.xu,{children:(0,s.jsx)(l.tv,{icon:c.q.attachment})})}),I&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.xu,{pl:5,onClick:D,children:(0,s.jsx)(l.tv,{size:20,icon:c.q.edit})}),(0,s.jsx)(u.xu,{pl:5,onClick:function(){return b(!0)},children:(0,s.jsx)(l.tv,{size:20,icon:c.q.trash})})]})]})]}),showBody:!0,hideBoxShadow:!0,hideBorder:!0,bodyDescription:(0,s.jsx)(l.xv,{children:(0,s.jsx)(y.NI,{style:{whiteSpace:"pre-wrap"},math:null!==(v=h.replyText)&&void 0!==v?v:"",sanitize:!C})}),showActionbar:!!(null===h||void 0===h?void 0:h.attachmentUrl)}),j&&(0,s.jsx)(f.iu,{isOpen:j,title:A("deleteReply"),secondaryAction:{title:A("noContinue"),onClick:function(){return b(!1)}},primaryAction:{onClick:g,title:A("yesDelete"),variant:"error"},children:A("deleteReplyMessage")})]})},S=n(36778);function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function g(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=function(e){var t=e.comments,n=e.stripAndDecode,l=e.postReply,c=e.editReply,a=e.deleteReply,d=e.discussionId,p=e.courseTitle,m=e.lessonTitle,f=e.postTitle,h=e.uploadFile,x=e.uploadToken,y=e.sharedAuthToken,D=e.isPostDiscussion,C=e.courseId,T=e.postId,j=e.lessonId,b=e.sharedUserId,A=e.getFileNameFromUrl,U=e.getCurrentPosition,_=e.courseSectionId,k=e.userEnrollmentState,F=e.isAnsweredByFaculty,P=(0,o.$)("discussion").t,L=(0,i.useState)(null),E=L[0],w=L[1];return(0,s.jsxs)(u.xu,{pl:4,children:[(0,s.jsx)(u.xu,{sx:{borderLeft:"2px solid",borderLeftColor:E?"transparent":"color-basic-default-border"},children:(0,s.jsx)(r.F,{itemData:g(t.commentIds).reverse(),variant:"list",removeGutter:!0,renderItem:function(e,i){var o=t.commentDetails[e];return(0,s.jsx)(u.xu,{pl:3,children:(0,s.jsx)(u.xu,{children:e===E?(0,s.jsx)(u.xu,{pl:4,children:(0,s.jsx)(v,{getCurrentPosition:U,postReply:l,editReply:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];w(null),t[0].data.reply_text===o.replyText&&t[0].data.attachment_url===o.attachmentUrl||c.apply(void 0,g(t))},submitButtonText:P("edit"),discussionId:d,courseTitle:p,postTitle:f,lessonTitle:m,inputType:"edit",inputFor:"reply",uploadFile:h,uploadToken:x,sharedAuthToken:y,isPostDiscussion:D,courseId:C,postId:T,lessonId:j,getFileNameFromUrl:A,commentId:e,initialValue:o.replyText,attachmentUrl:o.attachmentUrl,courseSectionId:_,inputLabel:P("editReply")})}):(0,s.jsx)(I,{getFileNameFromUrl:A,isByCurrentUser:o.userInfo.userId===b,stripAndDecode:n,comment:o,onClickEdit:function(){return w(e)},onClickDelete:function(){return a(e)},isByFaculty:F(t.commentDetails,[e])})})},e)}})}),!E&&!!b&&(k===S.T_.PURCHASED||D)&&(0,s.jsx)(u.xu,{pl:[0,0,0],py:0,children:(0,s.jsx)(v,{postReply:l,editReply:c,submitButtonText:P("reply"),discussionId:d,courseTitle:p,postTitle:f,lessonTitle:m,inputType:"create",inputFor:"reply",uploadFile:h,uploadToken:x,sharedAuthToken:y,isPostDiscussion:D,courseId:C,postId:T,lessonId:j,getFileNameFromUrl:A,courseSectionId:_,placeholderText:P("addYourReplyHere")})})]})},T=n(38398),j=n(27247);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var s,i,o=[],r=!0,l=!1;try{for(n=n.call(e);!(r=(s=n.next()).done)&&(o.push(s.value),!t||o.length!==t);r=!0);}catch(u){l=!0,i=u}finally{try{r||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U=function(e){var t,n,r,a,d,p,m,v,h,I,S,D=(0,o.$)("discussion").t,g=(0,i.useState)(!1),C=g[0],b=g[1],U=e.discussionDetail,_=e.stripAndDecode,k=e.getFileNameFromUrl,F=e.onToggleDiscussion,P=(e.decodeHtmlEntities,e.isByCurrentUser),L=e.onClickEdit,E=e.convertSecToTime,w=e.AppendSuffixZero,N=e.onClickDelete,R=e.courseData,O=e.setCurrentAccessingLesson,B=e.getSlideNumber,$=e.navigateBack,z=e.isAllDiscussionScreen,H=e.isAnsweredByFaculty,Q=null===(t=k(null!==(m=null===U||void 0===U?void 0:U.attachmentUrl)&&void 0!==m?m:""))||void 0===t?void 0:t.toLocaleUpperCase(),q=(0,i.useMemo)((function(){return H(U.comments.commentDetails,U.comments.commentIds)}),[{discussionDetail:U,isAnsweredByFaculty:H}]),M=(0,i.useMemo)((function(){return U.userInfo.userRole!==T.xZ.STUDENT}),[U.userInfo.userRole]),Z=(0,i.useCallback)((function(){var e=U.lessonLink;if(e&&e.includes("?")){var t=!1,n=e.split("?")[1].split(":"),s={initialSlideIdx:Number(n[1]),initialSlideSeekPos:parseInt(n[2],0)};if(s.initialSlideIdx>0)return D("discussionTag.slide",{slideNo:s.initialSlideIdx+1});(e.includes("pdf")||e.includes("epdf"))&&(t=!0);var i=E(s.initialSlideSeekPos),o=i.hours,r=i.minutes,l=i.seconds;return 0!==o||0!==r||0!==l||t?t?D("discussionTag.pdf",{pageNo:0===s.initialSlideSeekPos?s.initialSlideSeekPos+1:s.initialSlideSeekPos}):D("discussionTag.video",{hours:w(o),minutes:w(r),seconds:w(l)}):null}return null}),[U,D]),G=(0,i.useCallback)((function(e){var t=null,n=0;return e&&R.currentCourseLessons&&R.currentCourseLessons.lessonDetails&&R.currentCourseLessons.lessonDetails[e]?{lessonSlides:t=R.currentCourseLessons.lessonDetails[e].slides,sectionId:n=R.currentCourseLessons.lessonDetails[e].sectionId}:{lessonSlides:t,sectionId:n}}),[R]);return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)(f.cS,{showHeader:!0,hideHeaderThumbnail:!0,headerTitle:(0,s.jsxs)(u.kC,{sx:{justifyContent:"space-between",width:"100%"},children:[(0,s.jsxs)(u.kC,{sx:{flexWrap:"wrap",alignItems:"center"},children:[(0,s.jsx)(l.qE,{size:"large",imageSource:null===U||void 0===U||null===(n=U.userInfo)||void 0===n?void 0:n.profilePhotoUrl,accessibilityLabel:null!==(v=null===U||void 0===U||null===(r=U.userInfo)||void 0===r?void 0:r.userName)&&void 0!==v?v:" ",status:M?"faculty":void 0}),(0,s.jsx)(u.kC,{sx:{flexDirection:"column",pl:2},children:(0,s.jsxs)(u.kC,{sx:{flexDirection:["column"],alignItems:["flex-start"]},children:[(0,s.jsx)(l.xv,{style:{display:"inline"},children:null===U||void 0===U||null===(a=U.userInfo)||void 0===a?void 0:a.userName}),(0,s.jsxs)(u.xu,{sx:{display:"flex",alignItems:"center"},children:[Z()&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.rU,{type:"internal",textProps:{category:"p2"},onClick:function(){return function(){var e;null===(e=document.getElementById("player-header"))||void 0===e||e.scrollIntoView();var t=U.lessonId,n=U.courseId,s=U.lessonLink||"",i=R.currentCourseSections,o=-1,r=G(t),l=r.lessonSlides,u=r.sectionId,c=0,a="";if(s.includes("?")){var d=s.split("?")[1].split(":");c=Number(d[2]),a=A(d,4)[3]}if(a&&l&&(o=B(a,l.slideDetails)),n&&u&&i&&i.sectionDetails&&i.sectionDetails[u]){var p={courseId:n,lessonSlides:l,sectionId:u,lessonId:t||i.sectionDetails[u].lessonIds[0],autoScrollLessonTs:(new Date).getTime()};o>-1&&(p.initialSlideIdx=o),c&&(p.initialSlideSeekPos=c),O(p,p.lessonId),z&&$()}return null}()},children:Z()}),(0,s.jsx)(u.xu,{sx:{display:["none","inline"]},children:(0,s.jsx)(l.xv,{children:"\xa0\u2022\xa0"})})]}),(0,s.jsx)(l.xv,{category:"c2",style:{display:"inline"},children:"".concat(x()(U.createdAt).fromNow())}),q&&(0,s.jsx)(u.xu,{pl:2,children:(0,s.jsx)(j.Z,{text:D("answered"),badgeShape:"square",badgeColor:"success",variant:"outline",badgeSize:"tiny"})})]})]})})]}),(0,s.jsxs)(u.kC,{children:[!!(null===U||void 0===U?void 0:U.attachmentUrl)&&(0,s.jsx)(u.xu,{children:(0,s.jsx)("a",{download:Q,href:"https://"+encodeURIComponent(decodeURIComponent(null!==(h=U.attachmentUrl)&&void 0!==h?h:"").replace("https://","")).replace("%2F","/"),children:(0,s.jsx)(l.tv,{size:20,icon:c.q.attachment})})}),P&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.xu,{pl:5,onClick:L,children:(0,s.jsx)(l.tv,{size:20,icon:c.q.edit})}),(0,s.jsx)(u.xu,{pl:5,onClick:function(){return b(!0)},children:(0,s.jsx)(l.tv,{size:20,icon:c.q.trash})})]})]})]}),showBody:!0,hideBoxShadow:!0,hideBorder:!0,bodyDescriptionNoOfLines:30,bodyDescription:(0,s.jsx)(l.xv,{category:"p1",children:(0,s.jsx)(y.NI,{style:{whiteSpace:"pre-wrap"},sanitize:!0,math:(null===U||void 0===U?void 0:U.discussionText)?_(null!==(I=null===U||void 0===U?void 0:U.discussionText)&&void 0!==I?I:""):null===U||void 0===U?void 0:U.discussionTitle})}),showActionbar:!0,showAction1:!0,action1:{text:D("replies",{count:null!==(S=null===U||void 0===U||null===(d=U.comments)||void 0===d||null===(p=d.commentIds)||void 0===p?void 0:p.length)&&void 0!==S?S:0}),icon:c.q.message,iconSize:19,textCategory:"s1",onHandleIcon:function(){return F(U.discussionId)}},variant:"titleCardWithoutBorder",disableHover:!0}),C&&(0,s.jsx)(f.iu,{isOpen:C,title:D("deleteQuestion"),primaryAction:{title:D("yesDelete"),onClick:N,variant:"error"},secondaryAction:{title:D("noContinue"),onClick:function(){return b(!1)}},children:D("deleteQuestionMessage")})]})},_=n(61611);function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function F(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=function(e){var t,n,c,a,d=e.data,p=e.getFileNameFromUrl,m=e.stripAndDecode,h=e.postQuestion,x=e.postReply,y=e.editQuestion,I=e.editReply,D=e.deleteQuestion,g=e.deleteReply,T=e.fetchCourseLevelDiscussion,j=e.fetchLessonLevelDiscussion,b=e.uploadFile,A=e.decodeHtmlEntities,k=e.convertSecToTime,P=e.AppendSuffixZero,L=e.setPlayerFocusState,E=e.getCurrentPosition,w=e.discussionFetchStatus,N=e.getSlideNumber,R=e.navigateBack,O=e.setCurrentAccessingLesson,B=e.isAnsweredByFaculty,$=d.discussion,z=$.postDiscussionUrlToken,H=$.discussionData,Q=$.isAllDiscussionScreen,q=d.courseData,M=q.courseUploadToken,Z=q.userEnrollmentState,G=d.sharedInfo,V=G.sharedAuthToken,K=G.sharedUserId,W=null===H||void 0===H?void 0:H.enrollmentType,J=d.discussion.discussionType===S.sV.POST_DISCUSSION,X=J?z:M,Y=(0,o.$)("discussion").t,ee=(0,i.useState)(),te=ee[0],ne=ee[1],se=(0,i.useState)(null),ie=se[0],oe=se[1];(0,i.useEffect)((function(){var e=null!==ie&&void 0!==ie?ie:te;e&&setTimeout((function(){var t;null===(t=document.getElementById(e.toString()))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"start"})}))}),[te,ie]);var re,le=(0,i.useCallback)((function(){Q?T(d.courseData.currentCourseId,d.courseData.currentBundleId,S.aw.LOAD_MORE,d.discussion.discussionData.currentPage+1,d.discussion.discussionType,d.discussion.discussionPostId,d.discussion.discussionPostTitle):j(d.courseData.currentLessonId,S.aw.LOAD_MORE,d.discussion.discussionData.currentPage+1)}),[T,d,Q]),ue=(0,i.useCallback)((function(e){ne(te===e?null:e),oe(null)}),[te]),ce=!!(null===d||void 0===d||null===(t=d.discussion)||void 0===t||null===(n=t.discussionData)||void 0===n?void 0:n.discussionIds)&&d.discussion.discussionData.currentPage<d.discussion.discussionData.totalPages,ae=null!==(re=null===d||void 0===d||null===(c=d.discussion)||void 0===c||null===(a=c.discussionData)||void 0===a?void 0:a.discussionIds)&&void 0!==re?re:[];return(0,s.jsxs)(u.xu,{children:[((W||Z)===S.T_.PURCHASED||J&&!!K)&&(0,s.jsx)(u.xu,{pt:0,pb:2,children:(0,s.jsx)(v,{getFileNameFromUrl:p,postQuestion:h,editQuestion:y,submitButtonText:Y("postDiscussion").toLocaleUpperCase(),courseId:d.courseData.currentCourseId||d.discussion.discussionCourseId,courseTitle:d.courseData.currentCourseSeoTitle,lessonId:d.courseData.currentLessonId,lessonTitle:d.courseData.currentLessonTitle,postId:d.discussion.discussionPostId,postTitle:d.discussion.discussionPostTitle,uploadFile:b,isPostDiscussion:J,uploadToken:X,sharedAuthToken:V,setPlayerFocusState:L,getCurrentPosition:E,courseSectionId:d.courseData.currentCourseSectionId,isLessonLevel:!!E,placeholderText:Y("startDiscussion")})}),0!==ae.length?(0,s.jsx)(r.F,{removeGutter:!0,renderItem:function(e,t){var n,i,o,r=null===d||void 0===d||null===(n=d.discussion)||void 0===n||null===(i=n.discussionData)||void 0===i||null===(o=i.discussionDetails)||void 0===o?void 0:o[e];return(0,s.jsxs)(u.xu,{id:e,children:[ie===e?(0,s.jsx)(u.xu,{px:3,children:(0,s.jsx)(v,{inputFor:"discussion",inputType:"edit",discussionId:e,postQuestion:h,editQuestion:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];oe(null),t[0].data.message===r.discussionText&&t[0].data.attachment_url===r.attachmentUrl||y.apply(void 0,F(t))},submitButtonText:Y("save").toLocaleUpperCase(),courseId:d.courseData.currentCourseId,courseTitle:d.courseData.currentCourseSeoTitle,lessonId:d.courseData.currentLessonId,lessonTitle:d.courseData.currentLessonTitle,postId:d.discussion.discussionPostId,postTitle:d.discussion.discussionPostTitle,uploadFile:b,isPostDiscussion:J,uploadToken:X,sharedAuthToken:V,initialValue:r.discussionText,attachmentUrl:r.attachmentUrl,getFileNameFromUrl:p,setPlayerFocusState:L,getCurrentPosition:E,courseSectionId:d.courseData.currentCourseSectionId,isLessonLevel:!!E,inputLabel:Y("editDiscussion")})}):(0,s.jsx)(U,{onClickEdit:function(){oe(e),ne(null)},decodeHtmlEntities:A,onToggleDiscussion:ue,stripAndDecode:m,getFileNameFromUrl:p,discussionDetail:r,isByCurrentUser:r.userInfo.userId===K,convertSecToTime:k,AppendSuffixZero:P,onClickDelete:function(){return D(e)},isAllDiscussionScreen:d.discussion.isAllDiscussionScreen,courseData:d.courseData,getSlideNumber:N,navigateBack:R,setCurrentAccessingLesson:O,isAnsweredByFaculty:B}),te===e&&!ie&&(0,s.jsx)(u.xu,{children:(0,s.jsx)(C,{userEnrollmentState:W||Z,courseSectionId:d.courseData.currentCourseSectionId,isPostDiscussion:J,comments:r.comments,getFileNameFromUrl:p,postReply:x,editReply:I,deleteReply:g,stripAndDecode:m,discussionId:e,uploadFile:b,uploadToken:X,sharedAuthToken:V,courseId:d.courseData.currentCourseId||d.discussion.discussionCourseId,courseTitle:d.courseData.currentCourseSeoTitle,lessonId:d.courseData.currentLessonId,lessonTitle:d.courseData.currentLessonTitle,postId:d.discussion.discussionPostId,postTitle:d.discussion.discussionPostTitle,sharedUserId:K,getCurrentPosition:E,isAnsweredByFaculty:B})}),t!==d.discussion.discussionData.discussionIds.length-1&&(0,s.jsx)(u.xu,{pt:0,children:(0,s.jsx)(l.iz,{})})]},e)},itemData:ae,variant:"list"}):(0,s.jsx)(f.T9,{title:Y("noDiscussionTitle"),subtitle:Y("noDiscussionMessage")}),ce&&w!==_.UK.IN_PROGRESS&&(0,s.jsx)(u.kC,{sx:{justifyContent:"center"},pt:8,pb:6,children:(0,s.jsx)(l.rU,{type:"internal",underline:!0,textProps:{category:"p1"},onClick:le,children:Y("viewMoreDiscussions")})}),w===_.UK.IN_PROGRESS&&(0,s.jsx)(u.xu,{pt:2,pb:10,children:(0,s.jsx)(l.aN,{})})]})},L=i.memo(P),E=function(e){var t,n,r,c,a,d=(0,o.$)("discussion").t,p=e.allDiscussionsData,m=p.callbacks,v=p.data,f=m.getFileNameFromUrl,h=m.StripHTML,x=m.decodeServerData,y=m.postReply,I=m.postQuestion,S=m.editQuestion,D=m.editReply,g=m.deleteQuestion,C=m.deleteComment,T=m.fetchLessonLevelDiscussion,b=m.fetchCourseLevelDiscussion,A=m.uploadFile,U=m.decodeHtmlEntities,_=m.convertSecToTime,k=m.AppendSuffixZero,F=m.navigateToDiscussion,P=m.getSlideNumber,E=m.setCurrentAccessingLesson,w=m.navigateBack,N=m.setPlayerFocusState,R=m.getCurrentPosition,O=m.isAnsweredByFaculty,B=(0,i.useCallback)((function(e){return x(h(e))}),[h,x]);return(0,s.jsxs)(u.kC,{sx:{flexDirection:"column",px:3,pt:3},children:[(0,s.jsxs)(u.kC,{sx:{justifyContent:"space-between",alignItems:["flex-start","center","center"],flexDirection:["column","row","row"]},pb:[2,0,0],children:[(0,s.jsxs)(u.kC,{sx:{alignItems:"center"},children:[(0,s.jsx)(l.xv,{category:"h4",sx:{pb:[0,0,0]},textTransform:"capitalize",children:d(R?"lessonDiscussion":"discussions")}),(0,s.jsx)(u.xu,{px:1}),(0,s.jsx)(j.Z,{text:null!==(a=null===(t=p.data)||void 0===t||null===(n=t.discussion)||void 0===n||null===(r=n.discussionData)||void 0===r||null===(c=r.discussionIds)||void 0===c?void 0:c.length)&&void 0!==a?a:0,variant:"subtle",badgeColor:"basic",badgeShape:"roundedEdges"})]}),!!R&&(0,s.jsx)(u.xu,{children:(0,s.jsx)(l.zx,{onClick:function(){return null===F||void 0===F?void 0:F({courseId:v.courseData.currentCourseId,courseSeo:v.courseData.currentCourseSeoTitle,bundleId:v.courseData.currentBundleId,bundleSeo:v.courseData.currentBundleSeoTitle})},style:{margin:"auto 0"},type:"ghost",children:(0,s.jsx)(l.xv,{children:d("product:viewAll")})})})]}),(0,s.jsx)(u.xu,{pt:[0,2,2],children:(0,s.jsx)(L,{convertSecToTime:_,AppendSuffixZero:k,stripAndDecode:B,getFileNameFromUrl:f,data:v,postQuestion:I,editQuestion:S,deleteQuestion:g,postReply:y,editReply:D,deleteReply:C,fetchCourseLevelDiscussion:b,fetchLessonLevelDiscussion:T,uploadFile:A,decodeHtmlEntities:U,setPlayerFocusState:N,getCurrentPosition:R,discussionFetchStatus:v.discussion.discussionFetchStatus,getSlideNumber:P,setCurrentAccessingLesson:E,navigateBack:w,isAnsweredByFaculty:O})})]})}}}]);